(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{220:function(t,s,e){"use strict";e.r(s);var n=e(2),a=Object(n.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",[t._v("前言：之前有篇文章介绍过Selenium的等待知识，可惜当时水平有限，只介绍了sleep和implicitly_wait的用法。今天还是补充一下WebDriverWait的相关知识")])]),t._v(" "),e("h2",{attrs:{id:"一、webdrivewait-示例代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、webdrivewait-示例代码"}},[t._v("#")]),t._v(" 一、webdrivewait 示例代码")]),t._v(" "),e("div",{staticClass:"language-python line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" webdriver\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ui "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" WebDriverWait\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("support "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" expected_conditions "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" EC\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" selenium"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webdriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("common"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("by "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" By\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n \ndriver "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" webdriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Chrome"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndriver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.baidu.com/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nlocator "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("By"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    ele "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" WebDriverWait"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("until"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("presence_of_element_located"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("locator"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_element_by_id"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kw"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("send_keys"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abc'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    time"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#为了看效果")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ele can\'t find"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br")])]),e("p",[t._v("接下来一点点分析下这个语句")]),t._v(" "),e("div",{staticClass:"language-python line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("WebDriverWait"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("driver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("until"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("presence_of_element_located"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("locator"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"（1）webdriverwait-方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#（1）webdriverwait-方法"}},[t._v("#")]),t._v(" （1）WebDriverWait 方法")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/kachacha/markdownPicture/docImg/20180108161211508.png",alt:""}})]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("\ndriver: 传入WebDriver实例，即我们上例中的driver\ntimeout: 超时时间，等待的最长时间（同时要考虑隐性等待时间）\npoll_frequency: 调用until或until_not中的方法的间隔时间，默认是0.5秒\nignored_exceptions: 忽略的异常，如果在调用until或until_not的过程中抛出这个元组中的异常，\n        则不中断代码，继续等待，如果抛出的是这个元组外的异常，则中断代码，抛出异常。默认只有NoSuchElementException。\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("p",[t._v("（2）WebDriverWait 方法后面有两种等待方式")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/kachacha/markdownPicture/docImg/20180108161611715.png",alt:""}})]),t._v(" "),e("p",[t._v("until")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("\nmethod: 在等待期间，每隔一段时间（__init__中的poll_frequency）调用这个传入的方法，直到返回值不是False\nmessage: 如果超时，抛出TimeoutException，将message传入异常\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("p",[t._v("until_not")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("与until相反，until是当某元素出现或什么条件成立则继续执行，\n until_not是当某元素消失或什么条件不成立则继续执行，参数也相同，不再赘述。\n\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br")])]),e("p",[t._v("看了以上内容基本上很清楚了，调用方法如下：")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("WebDriverWait(driver, 超时时长, 调用频率, 忽略异常).until(可执行方法, 超时时返回的信息)\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("这里需要特别注意的是until或until_not中的可执行方法method参数，很多人传入了WebElement对象，如下：")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("WebDriverWait(driver, 10).until(driver.find_element_by_id('kw'))  # 错误\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("这是错误的用法，这里的参数一定要是可以调用的，即这个对象一定有 "),e("strong",[t._v("call")]),t._v("() 方法，否则会抛出异常：")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("TypeError: 'xxx' object is not callable\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("在这里，你可以用selenium提供的 expected_conditions 模块中的各种条件，也可以用WebElement的 is_displayed() 、is_enabled()、is_selected() 方法，或者用自己封装的方法都可以，那么接下来我们看一下selenium提供的条件有哪些：")]),t._v(" "),e("h4",{attrs:{id:"expected-conditions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#expected-conditions"}},[t._v("#")]),t._v(" expected_conditions")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/kachacha/markdownPicture/docImg/20180108162445157.png",alt:""}})]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/kachacha/markdownPicture/docImg/20180108162549799.png",alt:""}})]),t._v(" "),e("p",[t._v("expected_conditions是selenium的一个模块，其中包含一系列可用于判断的条件：")]),t._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("\nselenium.webdriver.support.expected_conditions（模块）\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("p",[t._v("以下两个条件类验证title，验证传入的参数title是否等于或包含于driver.title\ntitle_is\ntitle_contains")]),t._v(" "),e("p",[t._v("以下两个条件验证元素是否出现，传入的参数都是元组类型的locator，如(By.ID, ‘kw’)\n顾名思义，一个只要一个符合条件的元素加载出来就通过；另一个必须所有符合条件的元素都加载出来才行\npresence_of_element_located\npresence_of_all_elements_located")]),t._v(" "),e("p",[t._v("以下三个条件验证元素是否可见，前两个传入参数是元组类型的locator，第三个传入WebElement\n第一个和第三个其实质是一样的\nvisibility_of_element_located\ninvisibility_of_element_located\nvisibility_of")]),t._v(" "),e("p",[t._v("以下两个条件判断某段文本是否出现在某元素中，一个判断元素的text，一个判断元素的value\ntext_to_be_present_in_element\ntext_to_be_present_in_element_value")]),t._v(" "),e("p",[t._v("以下条件判断frame是否可切入，可传入locator元组或者直接传入定位方式：id、name、index或WebElement\nframe_to_be_available_and_switch_to_it")]),t._v(" "),e("p",[t._v("以下条件判断是否有alert出现\nalert_is_present")]),t._v(" "),e("p",[t._v("以下条件判断元素是否可点击，传入locator\nelement_to_be_clickable")]),t._v(" "),e("p",[t._v("以下四个条件判断元素是否被选中，第一个条件传入WebElement对象，第二个传入locator元组\n第三个传入WebElement对象以及状态，相等返回True，否则返回False\n第四个传入locator以及状态，相等返回True，否则返回False\nelement_to_be_selected\nelement_located_to_be_selected\nelement_selection_state_to_be\nelement_located_selection_state_to_be")]),t._v(" "),e("p",[t._v("最后一个条件判断一个元素是否仍在DOM中，传入WebElement对象，可以判断页面是否刷新了\nstaleness_of")]),t._v(" "),e("p",[t._v("上面是所有17个condition，与until、until_not组合能够实现很多判断，如果能自己灵活封装，将会大大提高脚本的稳定性。")]),t._v(" "),e("p",[t._v("封装示例：")]),t._v(" "),e("p",[t._v("待补充")])])}),[],!1,null,null,null);s.default=a.exports}}]);